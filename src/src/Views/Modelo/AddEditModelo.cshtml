@model src.Models.Modelo

@{
    Layout = null;
}
<h4>Modelo</h4>
<hr />
<div class="row">
    <div class="col-md-12">
        <form asp-area="" asp-controller="Modelo" asp-action="Create" onsubmit="return SubmitAddEditModelo(this)">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" asp-for="modeloId" />
            <div class="form-group">
                <label asp-for="modeloDesc" class="control-label"></label>
                <input asp-for="modeloDesc" class="form-control" />
                <span asp-validation-for="modeloDesc" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="marcaid" class="control-label"></label>
                <span asp-validation-for="marcaid" class="text-danger"></span>
                <select asp-for="marcaid" class="form-control" id="dropDownMarca">
                </select>
            </div>
            <div class="form-group">
                <input type="submit" value="Salvar" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">

    FillSelectValues();

    function FillSelectValues() {
        debugger;
        $.ajax({
            type: 'GET',
            url: '/api/Marca/Marcas',
            contentType: 'application/json',
            success: function (data) {
                debugger;
                $.each(data, function (key, value) {
                    debugger;
                    $("<option/>", { value: key, text: value })
                        .appendTo('#dropDownMarca')
                });
                debugger;
                $('[id=dropDownMarca]').val(@Model.marcaid);
            }

        });

    }

    function SubmitAddEditModelo(form) {
        $.validator.unobtrusive.parse(form);
        if ($(form).valid()) {
            var data = $(form).serializeJSON();
            data = JSON.stringify(data);
            $.ajax({
                type: 'POST',
                url: '/api/modelo',
                data: data,
                contentType: 'application/json',
                success: function (data) {
                    if (data.success) {
                        popup.dialog('close');
                        ShowMessage(data.message);
                        dataTable.ajax.reload();
                    }
                }
            });

        }
        return false;
    }

</script>